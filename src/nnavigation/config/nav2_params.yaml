amcl:
  ros__parameters:
    use_sim_time: false
    scan_topic: /waffle2/scan
    odom_frame_id: waffle2/odom
    base_frame_id: waffle2/base_link
    # Add valid parameters here or remove this section if not needed

map_server:
  ros__parameters:
    use_sim_time: false
    yaml_filename: ./config/map.yaml

bt_navigator:
  ros__parameters:
    use_sim_time: false

controller_server:
  ros__parameters:
    use_sim_time: false
    robot_base_frame: waffle2/base_link

planner_server:
  ros__parameters:
    use_sim_time: false
    expected_planner_frequency: 10.0

behavior_server:
  ros__parameters:
    use_sim_time: false

local_costmap:
  ros__parameters:
    plugins: ["obstacle_layer", "inflation_layer"]
    robot_base_frame: waffle2/base_link
    footprint: waffle2/base_footprint
    obstacle_layer:
      plugin: "nav2_costmap_2d::ObstacleLayer"
      enabled: true
      observation_sources: scan
      scan:
        topic: /waffle2/scan
        sensor_frame: laser_frame  # or base_scan, whatever your TF uses
        data_type: LaserScan
        clearing: true
        marking: true
        min_obstacle_height: 0.0
        max_obstacle_height: 2.0

global_costmap:
  ros__parameters:
    plugins: ["static_layer", "obstacle_layer", "inflation_layer"]
    robot_base_frame: waffle2/base_link
    static_layer:
      plugin: "nav2_costmap_2d::StaticLayer"
      map_topic: /map
      subscribe_to_updates: true
      track_unknown_space: false
      use_maximum: false

    obstacle_layer:
      plugin: "nav2_costmap_2d::ObstacleLayer"
      enabled: true
      observation_sources: /waffle2/scan
      scan:
        topic: /waffle2/scan
        sensor_frame: waffle2/base_scan  # or base_scan, whatever your TF uses
        data_type: LaserScan
        clearing: true
        marking: true
        min_obstacle_height: 0.0
        max_obstacle_height: 2.0

controller_server:
  ros__parameters:
    use_sim_time: false
    controller_plugins: ["FollowPath"]

    robot_base_frame: waffle2/base_link

    current_goal_checker: "goal_checker"

    goal_checker:
      plugin: "nav2_controller::SimpleGoalChecker"
      xy_goal_tolerance: 0.25
      yaw_goal_tolerance: 0.25

    FollowPath:
      plugin: "dwb_core::DWBLocalPlanner"
      debug_trajectory_details: false

      critics: [
        "RotateToGoal",
        "Oscillation",
        "ObstacleFootprint",
        "GoalAlign",
        "PathAlign",
        "PathDist",
        "GoalDist"
      ]

      GoalDist.scale: 1.0
      PathDist.scale: 32.0
      PathAlign.scale: 32.0
      GoalAlign.scale: 24.0
      ObstacleFootprint.scale: 0.01
      Oscillation.scale: 1.0
      RotateToGoal.scale: 32.0

      max_vel_x: 0.05
      min_vel_x: 0.0
      max_vel_theta: 0.2
      min_vel_theta: -0.2
      acc_lim_x: 0.5
      acc_lim_theta: 0.2